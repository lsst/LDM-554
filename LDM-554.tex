\documentclass[SE,toc,lsstdraft]{lsstdoc}

% We use commands to make it easy to find where parameter names and units
% are defined in the tables, and to allow hyphenation.
\newcommand{\paramname}[1]{\hspace{0pt}#1}
\newcommand{\unitname}[1]{\hspace{0pt}#1}

\setcounter{secnumdepth}{5}

%% Retrieve date and model version
\setDocUpstreamLocation{MagicDraw SysML}
\setDocUpstreamVersion{33}

\date{2017-07-03}

%% Define the document title, authors, handle, and change record
\input metadata.tex

% Environment for displaying the parameter tables in
% a consistent manner. No arguments as there are no
% captions or labels.
\newenvironment{parameters}[0]{%
\setlength\LTleft{0pt}
\setlength\LTright{\fill}
\begin{small}
\begin{longtable}[]{|p{0.49\textwidth}|l|p{0.6in}|p{1.70in}@{}|}

\hline \textbf{Description} & \textbf{Value} & \textbf{Unit} & \textbf{Name} \\ \hline
\endhead

\hline \multicolumn{4}{r}{\emph{Continued on next page}} \\
\endfoot

\hline\hline
\endlastfoot
}{%
\hline
\end{longtable}
\end{small}
}

\begin{document}
\maketitle

These requirements set out the major components of the LSST Science Platform (LSP).
\section{Science Platform}

\subsection{Overview}

\subsubsection{API Aspect}

\label{DMS-LSP-REQ-0004}
\textbf{ID:} DMS-LSP-REQ-0004

\textbf{Specification:}
The LSP shall provide a Web API for access to all the LSST data products and the user storage resources.

\textbf{Discussion:}
The Web API will use VO standards as much as is practical and supported by community expectations; see DMS-REQ-LSP-xxx below.  It may also include additional APIs to provide services unique to LSST.

\subsubsection{Access to All Released or Authorized Data Products}

\label{DMS-LSP-REQ-0001}
\textbf{ID:} DMS-LSP-REQ-0001

\textbf{Specification:}
The LSP shall provide the capability to access all the Project's released data products, including, but not limited to, the data products enumerated in the DPDD (\citeds{LSE-163}), as well as all user data products to which a user has access.

\subsubsection{Abide by the Data Access Policies}

\label{DMS-LSP-REQ-0007}
\textbf{ID:} DMS-LSP-REQ-0007

\textbf{Specification:}
The LSP shall comply with the public data access policy and access restrictions defined by the LSST Project and operations organization.

\textbf{Discussion:}
This includes both the enforcement of Project-level data rights (e.g., to the Level 1 and Level 2 data) and user-provided access controls to user-created data (e.g., Level 3 data products).

\subsubsection{Linkage of Aspects}

\label{DMS-LSP-REQ-0005}
\textbf{ID:} DMS-LSP-REQ-0005

\textbf{Specification:}
The LSP shall facilitate access to the same LSST and user data through multiple aspects.

\textbf{Discussion:}
It should be possible to identify or create data in one aspect and retrieve it in another.  This requirement is satisfied principally by building the various aspects over the same underlying data services.

\subsubsection{Notebook Aspect}

\label{DMS-LSP-REQ-0003}
\textbf{ID:} DMS-LSP-REQ-0003

\textbf{Specification:}
The LSP shall provide an interactive Python computing environment, accessible through a Web browser, with access to all the LSST data products and to user computing and storage resources.

\textbf{Discussion:}
The term "Notebook aspect" (and, \textit{a fortiori}, "Jupyter[Lab] aspect", which has also been used in DM discussions) refers to the reference implementation of this aspect of the LSP in terms of Jupyter notebooks and the forthcoming JupyterLab successor to that technology, with an IPython kernel back end. For the purposes of this requirements document, however, it seems preferable to avoid using an external brand name in the normative text.

\subsubsection{Portal Aspect}

\label{DMS-LSP-REQ-0002}
\textbf{ID:} DMS-LSP-REQ-0002

\textbf{Specification:}
The LSP shall provide a Web-based "Portal" means of access to all the LSST data products, and to user storage resources.

\textbf{Discussion:}
The Portal is defined by further requirements.

\subsubsection{Use of VO Standards}

\label{DMS-LSP-REQ-0006}
\textbf{ID:} DMS-LSP-REQ-0006

\textbf{Specification:}
The LSP shall utilize stable and accepted Virtual Observatory standards for publically offered APIs wherever feasible.

\textbf{Discussion:}
The intent is to establish a "VO First" posture, and require explicit exception be requested for any APIs needing to deviate from this requirement.
This requirement applies most importantly to the API Aspect's externally-facing data access APIs, but also in other areas.
E.g., from this requirement we may derive that the Portal must support access to externally-source reference catalog via VO-compliant queries, or that a Portal service for pushing data to user applications should support SAMP.

\subsection{Discover Data}

\subsubsection{Semantic Linkage}

\label{DMS-LSP-REQ-0008}
\textbf{ID:} DMS-LSP-REQ-0008

\textbf{Specification:}
The LSP shall support the identification of linkages between data items that reflect their provenance and data dependencies.

\textbf{Discussion:}
For instance, from a calibrated image it should be possible to identify the raw image from which it was generated, and the calibration data used in its processing; from a catalog entry it should be possible to identify the image(s) on which the measurement was made.
In practice this has DM system-level implications.  For the LSP it relies on upstream components recording the appropriate provenance metadata.  At the DAX level it mainly just requires exposing the tables and columns containing this metadata, and identifying them as such (e.g., by reporting foreign-key relationships) in the Reflection APIs.  At the Notebook level this is largely satisfied by providing Butler-level access to this information.

\subsubsection{Transfer of Portal Data References to Notebook}

\label{DMS-LSP-REQ-0010}
\textbf{ID:} DMS-LSP-REQ-0010

\textbf{Specification:}
The LSP shall facilitate the transfer to the Notebook aspect of references allowing retrieval in a notebook of the data explored in the Portal session.

\textbf{Discussion:}
This allows a user to locate and preview data in the Portal environment and then readily transfer their work to the Notebook aspect for detailed analysis.

\subsubsection{Semantic Linkage: Uncertainties}

\label{DMS-LSP-REQ-0009}
\textbf{ID:} DMS-LSP-REQ-0009

\textbf{Specification:}
The LSP shall support the identification of relationships between data items (notably database columns) that represent a quantity and its uncertainty(ies).

\textbf{Discussion:}
This should extend to relationships between groups of quantities and other quantities that represent their covariances, but this is not an open-ended requirement to support all such cases.
These relationships should be expressed as appropriate to the LSP aspect, and require "upstream" support at the point of definition or creation of the data.

\subsection{Query Data}

\subsubsection{General Tabular Queries}

\paragraph{Specific Query Types}\hfill  % Force subsequent text onto new line

\subparagraph{Temporal Queries}\hfill  % Force subsequent text onto new line

\subparagraph{Spatial Queries}\hfill  % Force subsequent text onto new line

\textsc{Spatial Query Parameters}

\textsc{Spatial Query Types}

\subparagraph{Identifier Queries}\hfill  % Force subsequent text onto new line

\subsubsection{Catalog Queries}

\subsubsection{Image Metadata Queries}

\subsubsection{Image Cutout Queries}

\subsection{Display Data}

\subsubsection{Display Tabular Data}

\paragraph{Property Sheets}\hfill  % Force subsequent text onto new line

\paragraph{Table Viewers}\hfill  % Force subsequent text onto new line

\paragraph{Tabular Data Graphing}\hfill  % Force subsequent text onto new line

\subsubsection{Display Image Data}

\paragraph{Image Display Tools}\hfill  % Force subsequent text onto new line

\paragraph{Image Overlays}\hfill  % Force subsequent text onto new line

\subsubsection{All-Sky Visualization}

\subsubsection{Coordinate Display Tools}

\subsection{Exploration and Analysis}

\subsubsection{Table Manipulation}

\subsubsection{Image Manipulation}

\subsubsection{Special Workflows}

\subsection{User Storage}

\subsubsection{User Workspace}

\label{DMS-LSP-REQ-0011}
\textbf{ID:} DMS-LSP-REQ-0011

\textbf{Specification:}
The LSP shall provide a "User Workspace": resources for the storage of user-generated data, which shall be accessible from all three aspects.

\textbf{Discussion:}
All users with data rights will have a "birthright" quota of User Workspace storage.  A proposal-based process will be available for requests for additional storage.  The Workspace will not, in general, place constraints on the format of the data stored.  It may be used for image data as well as for tabular data in file-oriented storage forms.  User databases are a separate mechanism.
The Workspace is expected to be made available through an implementation of the IVOA VOSpace standard.

\subsubsection{User Database Access Controls}

\label{DMS-LSP-REQ-0013}
\textbf{ID:} DMS-LSP-REQ-0013

\textbf{Specification:}
The LSP shall permit users to place access restrictions on user databases, based on both user and user-group identities, and shall enforce these restrictions in all its aspects.

\subsubsection{User Databases (Level 3 Data Products)}

\label{DMS-LSP-REQ-0012}
\textbf{ID:} DMS-LSP-REQ-0012

\textbf{Specification:}
The LSP shall provide for the creation, use, and management of user databases (Level 3 tabular data products), and shall enable interaction with user databases with the same facilities as for Project-created database to the extent feasible.

\textbf{Discussion:}
Some database-related capabilities of the LSP rely on the availability of detailed metadata on the Project-created databases that goes beyond the normal content of a database schema (e.g., IVOA UCDs for table columns).  Users will be enabled, but not required, to supply such metadata for their own databases (and they may do so incorrectly), so LSP functionality that depends on it may not be available for user databases.

\subsection{Transfer Data}

\subsubsection{Tabular Data Download File Formats}

\label{DMS-LSP-REQ-0017}
\textbf{ID:} DMS-LSP-REQ-0017

\textbf{Specification:}
The LSP shall allow tabular search results, including but not limited to data from the source and object tables and the image metadata tables, to be downloaded or saved to the workspace in at least the following formats: FITS table, VOTable, and ASCII delimiter-separated table (e.g., CSV).

\textbf{Discussion:}
A final set of formats needs to be discussed and approved by the Project.
This is primarily a requirement on the API aspect and the DAX services.

\subsubsection{Transfer Data to Workspace}

\label{DMS-LSP-REQ-0016}
\textbf{ID:} DMS-LSP-REQ-0016

\textbf{Specification:}
Transfer of data to and from the Workspace shall be usable as an alternative in all features of the LSP where download or upload, respectively, are available.

\textbf{Discussion:}
The user can "download" data, e.g., a query result, to the Workspace, and can "upload" data from the Workspace into other functions of the LSP, e.g., to use as a target list in a multi-object search.

\subsubsection{Upload Data}

\label{DMS-LSP-REQ-0015}
\textbf{ID:} DMS-LSP-REQ-0015

\textbf{Specification:}
The LSP shall provide means for uploading data from the user's system for use in the LSP aspects, including for storage in the Workspace.

\subsubsection{Image Data Download File Format}

\label{DMS-LSP-REQ-0018}
\textbf{ID:} DMS-LSP-REQ-0018

\textbf{Specification:}
The LSP shall allow LSST image data products to be downloaded or saved to the workspace as FITS files including the appropriate metadata.

\textbf{Discussion:}
This needs some discussion as to what other formats we may want and must be readable by future releases.

\subsubsection{Download Data}

\label{DMS-LSP-REQ-0014}
\textbf{ID:} DMS-LSP-REQ-0014

\textbf{Specification:}
The LSP shall provide means for downloading data resulting from queries or other operations, or from the Workspace, to the user's system.

\textbf{Discussion:}
In general the API aspect can be used to retrieve data to remote sites.  Additional mechanisms will be provided as appropriate to the various aspects, and are described in lower-level requirements.  For the DAC instances of the LSP, the "user's system" will generally be on the public Internet; for other instances it may be on project-internal systems.

\subsection{Control and Management}

\subsubsection{Alert Subscription}

\subsection{Documentation}

\subsubsection{Documentation}

\label{DMS-LSP-REQ-0019}
\textbf{ID:} DMS-LSP-REQ-0019

\textbf{Specification:}
The LSP shall provide user and reference documentation for all its aspects.

\subsection{General}

\subsubsection{Identity and Security}

\paragraph{New-user Support}\hfill  % Force subsequent text onto new line

\label{DMS-LSP-REQ-0021}
\textbf{ID:} DMS-LSP-REQ-0021

\textbf{Specification:}
The Portal and Notebook aspects shall provide guidance to unauthenticated users as to how to establish an identity as usable for authentication to the LSP.

\textbf{Discussion:}
This could be as simple as a link to a "register for LSST access" page from the login screens of the Portal and Notebook.

\paragraph{Authenticated User Access}\hfill  % Force subsequent text onto new line

\label{DMS-LSP-REQ-0020}
\textbf{ID:} DMS-LSP-REQ-0020

\textbf{Specification:}
The functions and services of the LSP, including all three aspects, shall be available only to authenticated users, except where other requirements or other change-controlled specifications authorize or mandate otherwise.

\paragraph{Privacy of User Activities}\hfill  % Force subsequent text onto new line

\label{DMS-LSP-REQ-0027}
\textbf{ID:} DMS-LSP-REQ-0027

\textbf{Specification:}
The LSP shall ensure that a user's activities on the LSP are not visible to other users without the originating user's explicit authorization.

\textbf{Discussion:}
Users will expect, for instance, that the queries they perform are not revealed to other users without their consent.

\paragraph{Common Identity}\hfill  % Force subsequent text onto new line

\label{DMS-LSP-REQ-0022}
\textbf{ID:} DMS-LSP-REQ-0022

\textbf{Specification:}
A user shall be able to use the same credentials to authenticate to all aspects of the LSP, and to receive access to any personal data or other state that is available cross-aspects.

\textbf{Discussion:}
This does not explicitly mandate "strong single-sign-on" in the sense that someone who has logged in to the Portal aspect can then proceed to the Notebook aspect without a separate login. (TBR: This behavior would be highly desirable and we may wish to adopt this as a requirement after all.) It \textit{does} require "weak single-sign-on" - the same credentials work everywhere.

\paragraph{Use of Multiple Sets of Credentials}\hfill  % Force subsequent text onto new line

\label{DMS-LSP-REQ-0024}
\textbf{ID:} DMS-LSP-REQ-0024

\textbf{Specification:}
The LSP shall permit users to associate multiple sets of credentials, from different providers, with the same identity within the LSP.

\paragraph{Use of External Identity Providers}\hfill  % Force subsequent text onto new line

\label{DMS-LSP-REQ-0023}
\textbf{ID:} DMS-LSP-REQ-0023

\textbf{Specification:}
The LSP shall permit users to authenticate to the system using external credentials, from identity providers determined to be trusted by the LSST project or its operations organization.

\textbf{Discussion:}
This means that a user should be able to authenticate to an instance of the LSP using, for example, Github credentials, or credentials from a home institution.
The policies for how LSST determines that an external user, with external credentials, has data rights and may establish an identity in LSST systems are set forth in other documents.

\paragraph{Acceptable Use Policy}\hfill  % Force subsequent text onto new line

\label{DMS-LSP-REQ-0025}
\textbf{ID:} DMS-LSP-REQ-0025

\textbf{Specification:}
Non-project-staff users of the LSP shall be required to agree to and abide by an Acceptable Use Policy, to be determined by the LSST project or its operations organization, as a condition of access to any Project instance of the LSP.

\textbf{Discussion:}
The policies for project staff are set in other documents.

\paragraph{Using secure protocols}\hfill  % Force subsequent text onto new line

\label{DMS-LSP-REQ-0026}
\textbf{ID:} DMS-LSP-REQ-0026

\textbf{Specification:}
All external connections to the LSP shall be encrypted using protocols and cipher suites compliant with LSST cybersecurity policy.

\textbf{Discussion:}
All connections from remote clients to LSST servers (including any web sockets to enable AJAX-like functionality) will be encrypted. It is expected that this will mean general use of "https:" protocols.
Connections back out to external archives that do not support secure communications may be left unencrypted.

\subsubsection{Implementation}

\paragraph{System-Availability Indication}\hfill  % Force subsequent text onto new line

\label{DMS-LSP-REQ-0035}
\textbf{ID:} DMS-LSP-REQ-0035

\textbf{Specification:}
The LSP aspects shall provide means to inform users when their services are unavailable, including for reasons of maintenance or excessive load.

\textbf{Discussion:}
This is a DM requirement, not just a Science Platform requirement, as it interacts with lower-level system-availability issues.
Even at LSP level this is a complicated problem, as availability of query services through the Portal, for instance, involves time budgeting and resource management for the all of the stages of the query: query generation, query running, results generation, display of results, and downloading and saving of results.

\paragraph{Internet-Accessible (IPv6)}\hfill  % Force subsequent text onto new line

\label{DMS-LSP-REQ-0034}
\textbf{ID:} DMS-LSP-REQ-0034

\textbf{Specification:}
The LSP shall support access from the public Internet using IPv6 protocols.

\textbf{Discussion:}
This covers all three aspects of the LSP and thus both browser and other Web-API access.

\paragraph{Internet-Accessible (IPv4)}\hfill  % Force subsequent text onto new line

\label{DMS-LSP-REQ-0033}
\textbf{ID:} DMS-LSP-REQ-0033

\textbf{Specification:}
The LSP shall support access from the public Internet using IPv4 protocols.

\textbf{Discussion:}
This covers all three aspects of the LSP and thus both browser and other Web-API access.

\paragraph{Multiple installations}\hfill  % Force subsequent text onto new line

\label{DMS-LSP-REQ-0032}
\textbf{ID:} DMS-LSP-REQ-0032

\textbf{Specification:}
The LSP design shall facilitate the installation and maintenance of multiple instances of the LSP and shall support both instances that are accessible from the public Internet and instances that are accessible only within the LSST Project.

\textbf{Discussion:}
In addition to the public instances at the Project-provided Data Access Centers, it is expected that additional instances will be used to support internal processes such as commissioning.
It is also desirable that the LSP be designed and implemented so that its components can readily be installed outside the Project-provided facilities (e.g., at IN2P3), but (TBR) this is not a formal requirement.

\subsubsection{Performance Requirements}

\paragraph{Query Result Download Bandwidth}\hfill  % Force subsequent text onto new line

\label{DMS-LSP-REQ-0031}
\textbf{ID:} DMS-LSP-REQ-0031

\textbf{Specification:}
The LSP shall support a download rate of 6 Gbps for query results including results tables and images.

\textbf{Discussion:}
This is a DM requirement and not solely an SUIT requirement; a discussion needs to take place regarding the time budgeting for the all of the stages of the query: query generation, query running, results generation, display of results, and downloading and saving of results.

\paragraph{Peak Volume for Queries on all Objects}\hfill  % Force subsequent text onto new line

\label{DMS-LSP-REQ-0029}
\textbf{ID:} DMS-LSP-REQ-0029

\textbf{Specification:}
The LSP shall handle at peak usage 20 simultaneous queries without degradation, with the following properties: input selection of up the entire object database, result data set of up to 6 GB, and a response time of one hour.

\textbf{Discussion:}
This is a DM requirement and not solely an SUIT requirement; a discussion needs to take place regarding the time budgeting for the all of the stages of the query: query generation, query running, results generation, display of results, and downloading and saving of results.

\paragraph{Peak Volume for Moderate-Sized Queries}\hfill  % Force subsequent text onto new line

\label{DMS-LSP-REQ-0028}
\textbf{ID:} DMS-LSP-REQ-0028

\textbf{Specification:}
The LSP shall handle at peak usage 50 simultaneous queries without degradation, with the following properties: input selection of up to 1E7 objects in the catalog, result data set of up to 0.1GB, and a response time of 10 seconds.

\textbf{Discussion:}
This is a DM requirement and not solely an SUIT requirement; a discussion needs to take place regarding the time budgeting for the all of the stages of the query: query generation, query running, results generation, display of results, and downloading and saving of results.

\paragraph{Peak Volume of In-process Queries}\hfill  % Force subsequent text onto new line

\label{DMS-LSP-REQ-0030}
\textbf{ID:} DMS-LSP-REQ-0030

\textbf{Specification:}
The LSP shall simultaneously handle at peak usage 20 * 6 GB = 120 GB downloads

\textbf{Discussion:}
This is a DM requirement and not solely an SUIT requirement; a discussion needs to take place regarding the time budgeting for the all of the stages of the query: query generation, query running, results generation, display of results, and downloading and saving of results.

\section{Portal}

\subsection{Discover Data}

\subsubsection{Semantic Linkage: Portal Workflows}

\label{DMS-PRTL-REQ-0004}
\textbf{ID:} DMS-PRTL-REQ-0004

\textbf{Specification:}
The Portal aspect shall provide for the identification and retrieval of semantically linked data.

\textbf{Discussion:}
The Portal should provide straightforward UI workflows for starting from a selected data item (image or catalog entry) and identifying related data, including both direct data-dependency and provenance linkages and more scientifically oriented linkages such as the ability to navigate from an Object to its associated ForcedSources.
Some of these linkages will be supported by the automatic exploitation of metadata exposed through the underlying data access APIs; others will be specifically designed workflows reflecting scientific understanding of the relationships among LSST data products and their processing.

\subsubsection{Coadded Image to Single-Epoch Image Associations}

\label{DMS-PRTL-REQ-0006}
\textbf{ID:} DMS-PRTL-REQ-0006

\textbf{Specification:}
The Portal aspect shall facilitate users following the associations between coadded images and the single epoch images that were used to generate them.

\textbf{Discussion:}
This is a sub-requirement of "Semantic Linkage: Portal" that carries forward a specific requirement originating from early SUIT specifications.

\subsubsection{Access to External Archives}

\label{DMS-PRTL-REQ-0007}
\textbf{ID:} DMS-PRTL-REQ-0007

\textbf{Specification:}
The Portal aspect shall provide an interface to outside catalog and image data services that are available via standard astronomical VO interfaces to enable a user to determine what external astronomical data are associated with a given location on the sky and return that data for use within the Portal.

\textbf{Discussion:}
The purpose of this requirement is to help users connect LSST data with other data already available in community archives (e.g., IRSA, NED, MAST, HEASARC), and should support any VO-compliant archive.  If access to a non-VO compliant archive is critical for the needs of the LSST project that could be considered here.

\subsubsection{Access to Calibration Products}

\label{DMS-PRTL-REQ-0005}
\textbf{ID:} DMS-PRTL-REQ-0005

\textbf{Specification:}
The Portal aspect shall enable access to Project calibration data products, both directly and via linkages from science data products generated using them.

\textbf{Discussion:}
This is a sub-requirement of "Semantic Linkage: Portal" that carries forward a specific requirement originating from early SUIT specifications.

\subsubsection{Portal Access to Workspace}

\label{DMS-PRTL-REQ-0003}
\textbf{ID:} DMS-PRTL-REQ-0003

\textbf{Specification:}
The Portal aspect shall have the capability to discover all data in the user's Workspace.

\textbf{Discussion:}
This will allow for data and images to be retrieved from the environment for use within the portal.

\subsubsection{Portal Discovery of all Data Products}

\label{DMS-PRTL-REQ-0002}
\textbf{ID:} DMS-PRTL-REQ-0002

\textbf{Specification:}
The Portal aspect shall provide the capability to discover and access all the Project's released data products, including, but not limited to, the data products enumerated in the DPDD (\citeds{LSE-163}), the calibration database, and the Reformatted EFD, as well as all user data products to which a user has access.

\textbf{Discussion:}
The Portal's workflows should allow a user to learn what data exist: what data releases are available, what image and catalog data they contain, the names of all databases, tables, and columns, etc.
For all tabular data products the Generic Query requirements below cover the basic level of access provided.

\subsubsection{API for Access to Portal Session State}

\label{DMS-PRTL-REQ-0008}
\textbf{ID:} DMS-PRTL-REQ-0008

\textbf{Specification:}
The Portal aspect shall provide a network API that allows authenticated remote access by a user to aspects of their session state in the Portal.  The minimal requirement is for access to the list of queries performed in that session.

\textbf{Discussion:}
Access to the list of queries allows user code in the Notebook aspect to use those query references to retrieve the data which was being explored in the Portal.

\subsection{Query Data}

\subsubsection{General Tabular Queries}

\paragraph{Specific Query Types}\hfill  % Force subsequent text onto new line

This section covers two key types of queries, temporal and spatial, for which it is often necessary to perform transformations from user specifications to internal forms, and for which there are specific community expectations.
Queries of these types may apply to any temporally or spatially organized tables, respectively, including both catalogs and image metadata tables.
The spirit of all the requirements in this section is that they should be satisfied by providing appropriate UI elements, not merely by the provision of the raw ADQL query capability to, e.g., code a box search.
It is assumed that the underlying query capabilities of the API aspect / DAX / database, and in particular the support for tabular queries with ADQL, will enable the implementation.
The availability of these queries is driven by the table and column metadata.

\subparagraph{Temporal Queries}\hfill  % Force subsequent text onto new line

\textsc{Query by Date and Time: Time Range of Observation}

\label{DMS-PRTL-REQ-0019}
\textbf{ID:} DMS-PRTL-REQ-0019

\textbf{Specification:}
The Portal aspect shall support queries based on times and ranges of date/time values in both UT and (barycentric) Julian date.

\textbf{Discussion:}
The intent of this requirement is to enable users to search for an event within a range of times/dates and is akin to a positional box search of images that overlap that time range or are fully enveloped in that time range.
This type of query should be available for all time-point based tables in the LSST data products (e.g., Visit, Source, ForcedSource, DIASource, and EFD), and more generally for all tables with columns indicated as times by their metadata (e.g., by UCDs).
The Portal is responsible for conversion of user-supplied times to the appropriate form for use in the underlying API aspect and database queries.

\subparagraph{Spatial Queries}\hfill  % Force subsequent text onto new line

Much of this section covers both catalog and image metadata queries.  In general the interpretation of a spatial query on image data is more complex than for catalog data.  The requirements at present do not attempt to fully define the specific variants of spatial image searches supported (e.g., "contains a specified point", "contains a specified region", "overlaps with a region", "is fully contained within a region", etc.).  We expect to support most or all common variants, but details of the underlying database systems may determine which variants are more or less performant.

\textsc{Spatial Query Parameters}

This section covers the means of specification of coordinates for spatial queries in the Portal UI.

\textbf{\textit{Positional Query: Astrophysical Coordinate Systems}}

\label{DMS-PRTL-REQ-0022}
\textbf{ID:} DMS-PRTL-REQ-0022

\textbf{Specification:}
The Portal aspect shall support positional queries based on the following astrophysical coordinate systems: equatorial, ecliptic, and galactic.

\textbf{Discussion:}
The UI should include information on (and possibly selection of) the particular definition of each available coordinate system.

\textbf{\textit{Positional Query: LSST Object and Source Identifiers}}

\label{DMS-PRTL-REQ-0024}
\textbf{ID:} DMS-PRTL-REQ-0024

\textbf{Specification:}
The Portal aspect shall support the specification of coordinates for use within all positional queries by the use of specific LSST catalog entry identifiers, including those for the Object, DIAObject, Source, and DIASource tables.  The default choice of coordinate columns within these tables to use for the ID-to-coordinate translation shall be documented and shall be able to be determined from the UI.

\textbf{Discussion:}
LSST object and source identifiers are not necessarily associated with previously known astrophysical sources.  The Portal will need to be able to interpret source and object names and return positions that can be used in positional-based searches.

\textbf{\textit{Positional Query: Position on the Sky}}

\label{DMS-PRTL-REQ-0020}
\textbf{ID:} DMS-PRTL-REQ-0020

\textbf{Specification:}
The Portal aspect shall support queries based on an astrophysical position (i.e., coordinates) on the sky.

\textbf{Discussion:}
The intent of this requirement is to enable users to search for data at or near locations in equatorial, ecliptic or galactic coordinates and not a specific astrophysical object.
The Portal is responsible for any conversion required to put the coordinate query parameters into the forms accepted by the underlying API aspect / DAX services.

\textbf{\textit{Positional Query: Astrophysical Source Name Lookup}}

\label{DMS-PRTL-REQ-0023}
\textbf{ID:} DMS-PRTL-REQ-0023

\textbf{Specification:}
The Portal aspect shall support the specification of coordinates for use within all positional queries by the use of source names in common community-established astrophysical source name lookup services.

\textbf{Discussion:}
Services include, but are not limited to, NED, SIMBAD, and Horizons

\textbf{\textit{Positional Query: Multiple Positions/Objects}}

\label{DMS-PRTL-REQ-0021}
\textbf{ID:} DMS-PRTL-REQ-0021

\textbf{Specification:}
The Portal aspect shall support list-based positional queries, with the coordinates used specified by any of the means of specifying positions required elsewhere herein.

\textbf{Discussion:}
Lists of positions may be uploaded or taken from the Workspace.  Efficient implementation of list-based queries requires a corresponding API aspect / DAX service, to avoid the submission of large numbers of separate queries.
The system is not required to, but may, accept lists in which different elements are specified in more than one of the supported means of specifying positions; e.g., it is not required to support a list that is partially in equatorial coordinates and partially in LSST object IDs, because of the parsing and interpretation complexities involved.  The implementation should not preclude adding the ability to mix specification types later one, guided by feedback from the user community as to what is most useful.

\textbf{\textit{Positional Query: Solar System Object Names}}

\label{DMS-PRTL-REQ-0025}
\textbf{ID:} DMS-PRTL-REQ-0025

\textbf{Specification:}
The Portal aspect shall support positional queries based on external Solar System Object identifiers, including names from, but not limited to, NASA’s Navigation and Ancillary Information Facility (NAIF), the Minor Planet Center, and JPL’s Horizons, coupled with a date/time range specification.

\textbf{Discussion:}
The intent here is to enable a user to enter a solar system object name (e.g., 25155 van Belle) and, for a given time range, get back a list of observations that LSST may have made of that object because the survey has overlapped the position of that object at the appropriate times.
This capability is expected to be available for tables that are both spatially and temporally organized, e.g., Visit or DIASource.

\textsc{Spatial Query Types}

\textbf{\textit{Positional Query by Region: Cone-Search}}

\label{DMS-PRTL-REQ-0026}
\textbf{ID:} DMS-PRTL-REQ-0026

\textbf{Specification:}
The Portal aspect shall support position-based queries based on a cone-shaped radial search.

\textbf{\textit{Positional Query by Region: Box-Search}}

\label{DMS-PRTL-REQ-0027}
\textbf{ID:} DMS-PRTL-REQ-0027

\textbf{Specification:}
The Portal aspect shall support position-based queries based on a coordinate-system box search.

\subparagraph{Identifier Queries}\hfill  % Force subsequent text onto new line

In general the Portal is required to support retrieval of data on any LSST data product entity (e.g., catalog row) by its unique ID.  The requirements in this section elaborate on that.

\textsc{Query by Identifier}

\label{DMS-PRTL-REQ-0028}
\textbf{ID:} DMS-PRTL-REQ-0028

\textbf{Specification:}
The Portal aspect shall provide UI support for performing queries for data on any LSST data product entity with a unique ID by that ID.

\textbf{Discussion:}
Given, e.g., an Object ID or a Visit ID, it should be possible to perform a query by that ID and retrieve all, or a selection of, the data for the corresponding Object or Visit.  This requirement is limited to the direct content of the corresponding table row; the following requirements add semantic workflows returning additional data.
It is desirable for this capability to be available wherever such a unique ID is displayed in the UI, though the mandatory requirement is only for a dedicated form for such a query.

\textsc{Query by LSST Object and Source Identifiers: Specific Match to Identifier}

\label{DMS-PRTL-REQ-0029}
\textbf{ID:} DMS-PRTL-REQ-0029

\textbf{Specification:}
The Portal aspect shall provide UI support to query and return data associated with a specific LSST (DIA)Object, (DIA)Source, or ForcedSource identifier, including catalog data associated with the entity as well as the image data and metadata directly associated with the measurement.

\textbf{Discussion:}
For example, for an Object ID query, the Portal will, upon request, return information on the coadded images on which the Object was observed.  For a ForcedSource ID, the Portal should return information on the associated Object and on the single-epoch image on which the ForcedSource measurement was made.

\textsc{Query by Solar System Objects: Specific Match to Identifier}

\label{DMS-PRTL-REQ-0030}
\textbf{ID:} DMS-PRTL-REQ-0030

\textbf{Specification:}
The Portal aspect shall provide UI support to query and return data specifically associated with a Solar System Object.

\textbf{Discussion:}
The Portal will need to be able to return the data (catalog and images) associated with a specific solar system identifier and that cover the time range wanted.  This requires that the SSO database will have identified known solar objects that have been observed.

\paragraph{Generic Query - Form-based}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0016}
\textbf{ID:} DMS-PRTL-REQ-0016

\textbf{Specification:}
The Portal aspect shall provide a search-builder form-based interface for generic table queries.  This facility may have reduced functionality for user tables for which the user has not provided full, or accurate, metadata.

\textbf{Discussion:}
The Discovery and Reflection API will be used to construct a form allowing query against any attribute of a table, taking the column metadata provided by the Reflection API into account to display units and other information that will help the user construct a meaningful query.
We wish to allow and facilitate, but not require, users to provide detailed metadata for the tables they create; when they do, the system will take advantage of it.

\paragraph{Query Result Size}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0018}
\textbf{ID:} DMS-PRTL-REQ-0018

\textbf{Specification:}
The Portal aspect shall provide Ui support for determining or estimating the number of rows matching the query criteria without generating a full return set.

\textbf{Discussion:}
Relies on row-counting in the ADQL submitted to the DAX services.

\paragraph{Generic Query}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0015}
\textbf{ID:} DMS-PRTL-REQ-0015

\textbf{Specification:}
The Portal aspect shall enable the generation of queries against any tabular data exposed in the API aspect.

\textbf{Discussion:}
Provision of this relies on the Discovery and Reflection API requirement.  The idea is that some level of query will automatically be provided for every table even for tables for which no deliberately-designed custom search screens are available.
Note that image metadata is tabular data, so a basic level of ability to query for lists of images is available through "generic queries", though more image-specific workflows will be provided.

\paragraph{Generic Query - ADQL-based}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0017}
\textbf{ID:} DMS-PRTL-REQ-0017

\textbf{Specification:}
The Portal aspect shall provide a means for entering a query against any table directly in ADQL.  This facility shall be available for every table, including user-supplied tables.

\textbf{Discussion:}
This is essentially a pass-through to the underlying API aspect TAP service.
UI support for selecting from available identifiers (e.g. table or column names) for use in the ADQL, based on the Discovery and Reflection API, would be highly desirable.
UI support for the specification of coordinate values for use in the ADQL, based on the Spatial Query Parameters requirements below, would also be desirable.

\subsubsection{Catalog Queries}

This section contains requirements on queries related to specific LSST catalogs.

\paragraph{Queries on the Alerts Database}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0033}
\textbf{ID:} DMS-PRTL-REQ-0033

\textbf{Specification:}
The Portal aspect shall provide a query interface to the Alert Database, allowing searches based on parameters which shall include, but may not be limited to, Alert ID, time of alert, position on the sky, filter, and alert characteristics.

\textbf{Discussion:}
This capability, as all others in this section, is limited to data rights holders.  Non-data-rights holders have access to alerts only through the alerts stream(s) sent to public brokers.

\paragraph{Query Tabular Data based upon Image MetaData}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0032}
\textbf{ID:} DMS-PRTL-REQ-0032

\textbf{Specification:}
The Portal aspect shall be able to support queries of catalog data that include constraints on the properties of the images on which the catalog measurements were made.

\textbf{Discussion:}
This allows, for instance, limiting the return of Source catalog entries to measurements made on images taken with constraints on airmass, moon angle, etc.

\paragraph{Access to Original Alert State}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0034}
\textbf{ID:} DMS-PRTL-REQ-0034

\textbf{Specification:}
The Portal aspect shall provide access to the alerts as they were originally raised.

\textbf{Discussion:}
This is in the context of features elsewhere in the system that may allow for a chain of annotations of alerts.

\paragraph{Tabular Data Query Specifications}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0031}
\textbf{ID:} DMS-PRTL-REQ-0031

\textbf{Specification:}
The Portal aspect shall provide a user interface to execute queries of the (DIA)Object and (DIA)Source tables, driven by the data dictionary associated with the tables.

\textbf{Discussion:}
This should be satisfied almost completely by the "Generic Query - Form-Based" requirement above, but with some additional work on the UI to produce a more friendly workflow.

\subsubsection{Image Metadata Queries}

Image metadata is a special case of tabular data.  Some dedicated search capabilities are provided for it beyond the generic tabular searches.

\paragraph{Query for Single Epoch Raft Images}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0036}
\textbf{ID:} DMS-PRTL-REQ-0036

\textbf{Specification:}
The Portal aspect shall enable a user to limit the list of images selected by a single-epoch visit image query to those from a specified raft.

\textbf{Discussion:}
The intent is to enable the return of every image from RAFT X as a function of time or filter to enable viewing just that raft.

\paragraph{Single-Epoch Image Query Specifications}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0038}
\textbf{ID:} DMS-PRTL-REQ-0038

\textbf{Specification:}
The Portal aspect shall provide UI support for queries for visits and their single-epoch images of specified type, based on image metadata parameters including pointing, time and date, and filter selection, as well as on parameters from the Reformatted EFD.

\textbf{Discussion:}
The parameters specifically named are expected to be highlighted in the UI, rather than requiring the user to scroll through a long generic-table-query form to find the appropriate fields.  The UI will provide support for generating a join query including tables from the R-EFD, and for selecting the R-EFD tables and columns to use.

\paragraph{Query for Single Epoch CCD Image}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0037}
\textbf{ID:} DMS-PRTL-REQ-0037

\textbf{Specification:}
The Portal aspect shall enable a user to limit the list of images selected by a single-epoch visit image query to those from a specified CCD.

\textbf{Discussion:}
The intent is to enable the return of every image from CCD X as a function of time or filter to enable viewing just that CCD.

\paragraph{Query for Single Epoch Visit Images}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0035}
\textbf{ID:} DMS-PRTL-REQ-0035

\textbf{Specification:}
The Portal aspect shall enable a user to proceed from a visit-selection query or a list of visits and return a list of all single-epoch images of a specified type corresponding to those visits.

\textbf{Discussion:}
The common image types will be raw, PVI (processed, i.e., calibrated, visit image), and difference image.

\paragraph{Coadded Image Query Specifications}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0039}
\textbf{ID:} DMS-PRTL-REQ-0039

\textbf{Specification:}
The Portal aspect shall provide UI support for queries for coadded images based on the image metadata that describe the provenance of the images (e.g., filters, position on the sky, date, number of single-epoch images, coverage, survey depth).

\subsubsection{Image Cutout Queries}

The queries which follow return the actual image data.

\paragraph{Query for Coadded Image Cutouts}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0041}
\textbf{ID:} DMS-PRTL-REQ-0041

\textbf{Specification:}
The Portal aspect shall enable a user to perform a coadded image query, as above, and additionally return a list of sub-images (i.e., cutouts) from the all-sky co-added images based upon user-specified center position and image size, including the appropriate metadata for describing the image cut-outs.

\textbf{Discussion:}
This is a front end to a cutout capability in the API aspect.

\paragraph{Query for Single Epoch Image Cutouts}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0040}
\textbf{ID:} DMS-PRTL-REQ-0040

\textbf{Specification:}
The Portal aspect shall enable a user to perform a single-epoch image query, as above, and additionally return a list of sub-images (i.e., cutouts) from them based upon a specified center position, time range, and image size, including the appropriate metadata for describing the image cut-outs.

\textbf{Discussion:}
This is a front end to a cutout capability in the API aspect.

\subsubsection{Support Synchronous and Asynchronous Queries}

\label{DMS-PRTL-REQ-0009}
\textbf{ID:} DMS-PRTL-REQ-0009

\textbf{Specification:}
The Portal aspect shall provide UI models for both synchronous and asynchronous queries, based on user preference, loading, and resource capabilities.

\textbf{Discussion:}
This Portal capability should include an interface to initiate, monitor, and control the execution of both sync and async queries, as well as browse their results. Long running queries may be forced to be asynchronous.
There is not a 1:1 relationship between this Portal capability and the analogous capability in the API aspect; for instance, the Portal may provide UI support for placing a long-running, technically synchronous (from the DAX perspective), query into the background from the user's perspective.

\subsubsection{Query Results Size Limitation}

\label{DMS-PRTL-REQ-0012}
\textbf{ID:} DMS-PRTL-REQ-0012

\textbf{Specification:}
The Portal aspect shall have a mechanism to notify a user that a query result has exceeded threshold(s) for the maximum results size allowed and that the query has been terminated or disallowed.

\textbf{Discussion:}
Again, the underlying DAX support for this needs to be understood.

\subsubsection{Query Status and Termination Notification}

\label{DMS-PRTL-REQ-0011}
\textbf{ID:} DMS-PRTL-REQ-0011

\textbf{Specification:}
The Portal aspect shall notify the user of the status of the database query including if the query had been terminated for any reason.

\textbf{Discussion:}
There needs to be an operations discussion about when and why database queries are terminated, and what sorts of notifications will be generated by DAX in such cases.

\subsubsection{Query Saving - Portal}

\label{DMS-PRTL-REQ-0014}
\textbf{ID:} DMS-PRTL-REQ-0014

\textbf{Specification:}
The Portal aspect shall provide a UI for the saving of a specification artifact for a user-performed query, either for downloading or for saving to the Workspace, and a UI for re-executing a saved query found in the Workspace or uploaded remotely.

\subsubsection{Long Query Backgrounding}

\label{DMS-PRTL-REQ-0010}
\textbf{ID:} DMS-PRTL-REQ-0010

\textbf{Specification:}
The Portal aspect shall notify the user if a query is estimated to take longer than 60 seconds and will allow the user to put the query in background if desired.

\textbf{Discussion:}
This requirement arose from user panel feedback and the original SUIT requirements review.  It requires support from DAX/database for query estimation and that is still TBD.  Having the query "in the background" refers to the user's perspective of being able to proceed with other work while waiting for it to complete, and may or may not involve a truly asynchronous DAX query.

\subsubsection{Query History Inspection}

\label{DMS-PRTL-REQ-0013}
\textbf{ID:} DMS-PRTL-REQ-0013

\textbf{Specification:}
The Portal aspect shall provide a user interface for browsing the history of LSST project and user database queries performed by the user, for re-executing a selected query on demand, and, for recent queries, re-retrieving their results.

\textbf{Discussion:}
The implementation of this capability is assumed to rest on the API aspect, and the underlying database systems, supporting this functionality. The Portal interface to this is a thin UI.  This should be imagined as a CASJobs-like query history.
Note that because the API aspect is shared between the Portal and Notebook, this capability can be used to retrieve in the Portal the results of queries recently executed in the Notebook aspect; this allows complex ADQL queries to be formulated programmatically in the Notebook while still permitting their results to be inspected in the Portal.
Because of the reliance on the API aspect, the Portal is not required to provide this capability for external archives.

\subsection{Display Data}

The Display Data requirements are unique to the Portal.  The Notebook and API aspects of the LSP do not provide visualization services as such, though of course the Notebook permits the use of a wide variety of visualization libraries.

\subsubsection{Display Tabular Data}

\paragraph{Property Sheets}\hfill  % Force subsequent text onto new line

\subparagraph{Table Row Property Sheet}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0047}
\textbf{ID:} DMS-PRTL-REQ-0047

\textbf{Specification:}
The Portal aspect shall permit the inspection of all the data in a single row of a tabular data query result as a "property sheet" for that row, taking advantage of available metadata to supply units and other semantic information for each column value.

\textbf{Discussion:}
Resources permitting, the property sheet may be elaborated to provide additional functionality (typically, further queries) associated with particular data items displayed.

Property sheets should, where enabled by metadata, appropriately exhibit relationships between columns, such by displaying a value and its uncertainty together.

The system \textit{must} provide a generic property sheet functionality for any table for which full metadata is available. It \textit{may} also provide custom property sheets for commonly-queried tables such as Object, ForcedSource, Visit, etc. that provide a more scientifically useful layout, and additional available workflows, than possible just from the metadata.

\subparagraph{Alert Visualization}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0048}
\textbf{ID:} DMS-PRTL-REQ-0048

\textbf{Specification:}
The Portal aspect shall provide for the users a "property sheet" for the contents of an alert packet including, but not necessarily limited to, the alert postage stamp image, the postage stamp time series, the photometric time series, the source and object information (e.g., position, brightness).

\textbf{Discussion:}
This display is based on a query performed on the alert database.  It may also be desirable to provide this functionality based on an actual published alert packet, e.g., by permitting the upload of such a packet for display.
The alert property sheet should facilitate further exploration based on, e.g., the associated Object IDs in the alert.

\paragraph{Table Viewers}\hfill  % Force subsequent text onto new line

\subparagraph{Copying of Tabular Data}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0052}
\textbf{ID:} DMS-PRTL-REQ-0052

\textbf{Specification:}
The Portal aspect shall provide the capability of interactively selecting and copying data within a displayed data table.

\textbf{Discussion:}
The intent of this requirement is to enable users to use the mouse to select fields within a displayed table and utilize standard copy mechanisms.

\subparagraph{Row Selection of Tabular Data}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0053}
\textbf{ID:} DMS-PRTL-REQ-0053

\textbf{Specification:}
The Portal aspect shall provide the capability to select, for display and downloading, specific rows within the tabular data.

\textbf{Discussion:}
The intent of this requirement is to enable users to decide which rows are desired for display and download and these may be different from the filtered rows (see filtering requirement below).

\subparagraph{Column Selection of Tabular Data}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0050}
\textbf{ID:} DMS-PRTL-REQ-0050

\textbf{Specification:}
The Portal aspect shall provide the capability to select, for display and downloading, specific columns within the tabular data viewer.

\textbf{Discussion:}
The intent of this requirement is to enable users to decide which columns are desired for display and download.

\subparagraph{Paging of Tabular Data}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0054}
\textbf{ID:} DMS-PRTL-REQ-0054

\textbf{Specification:}
The Portal aspect shall provide the capability to display tabular data in a paged format.

\textbf{Discussion:}
The intent of this requirement is to capture that the database query returns may be too large to display all at once to the user and a form of paging will be necessary.

\subparagraph{Display Order of Columns of Tabular Data}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0051}
\textbf{ID:} DMS-PRTL-REQ-0051

\textbf{Specification:}
The Portal aspect shall provide the capability to change the display order of the columns for tabular data.

\textbf{Discussion:}
The intent of this requirement is to enable users to decide which order to view the columns.

\subparagraph{Display of Tabular Data}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0049}
\textbf{ID:} DMS-PRTL-REQ-0049

\textbf{Specification:}
The Portal aspect provide the capability to display tabular data in an interactive environment which displays the tables by columns and rows.

\textbf{Discussion:}
The intent of this requirement is to capture that the database query returns are displayed.

\paragraph{Tabular Data Graphing}\hfill  % Force subsequent text onto new line

\subparagraph{Symbol Size, Shape, and Color Coding in XY(Z) Scatter Plots}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0057}
\textbf{ID:} DMS-PRTL-REQ-0057

\textbf{Specification:}
The Portal aspect shall enable the use of symbol size, shape, and color as indicators of additional tabular data associated with the XY(Z)-data plotted.

\textbf{Discussion:}
This is a generalized requirement to enable the visualization of multi-dimensional data in a 2-d scatter plot environment.

\subparagraph{Plot Asymmetric Quantitative Uncertainties}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0059}
\textbf{ID:} DMS-PRTL-REQ-0059

\textbf{Specification:}
The Portal aspect shall be able represent uncertainties in the plotting of data that are unequal in value for the positive and negative directions.

\textbf{Discussion:}
Uncertainties often have different limits in the positive and negative directions and as a result representation of the uncertainties will be different.

\subparagraph{Histograms}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0056}
\textbf{ID:} DMS-PRTL-REQ-0056

\textbf{Specification:}
The Portal aspect shall enable the creation and display of 1-dimensional and 2-dimensional histograms of tabular data.

\textbf{Discussion:}
This requirement is about producing traditional histograms in 1 and 2 dimensions where the number of items within a bin are reported

\subparagraph{Plot Upper and Lower Quantitative Limits}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0060}
\textbf{ID:} DMS-PRTL-REQ-0060

\textbf{Specification:}
The Portal aspect shall be able represent upper and lower limits in the plotting of tabular data.

\textbf{Discussion:}
Often the values are non-detections and a limit is estimated on that value.  The limit can be an upper limit (e.g., flux) or a lower limit (e.g., magnitude).  Typically, the limit is represented by a flat line at the position of the value and an up or down arrow from that position.
For tables with full metadata including UCDs this can be handled generically: the "stat.min" and "stat.max" UCDs can be used to trigger the display of the distinctive symbols.

\subparagraph{XY Scatter Plots}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0055}
\textbf{ID:} DMS-PRTL-REQ-0055

\textbf{Specification:}
The Portal aspect shall enable the creation and display of 2-dimensional xy-plots from tabular data.

\subparagraph{Multiple XY-Plots on the Same Display}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0061}
\textbf{ID:} DMS-PRTL-REQ-0061

\textbf{Specification:}
The Portal aspect shall be able to overlay multiple plots on the same display, differentiated by plotting colors, symbols, line styles, and shading.

\textbf{Discussion:}
The intent of this requirement is enable the plotting of multiple graphs on the same plotting canvas.  An example would be RA vs Time and Dec vs Time or u-band mag vs i-z color and r-band mag vs i-z color.

\subparagraph{Plot Quantitative Uncertainties}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0058}
\textbf{ID:} DMS-PRTL-REQ-0058

\textbf{Specification:}
The Portal aspect shall be able represent uncertainties in the plotting of data.

\textbf{Discussion:}
This flows down from higher-level requirements above, and has implications for the creation of the necessary metadata to support this in the first place.

\subsubsection{Display Image Data}

NB: These requirements are solely about \textit{displaying} images in the Portal, not querying for them. It is highly likely that they will all be satisfied with the same SUIT component; they are enumerated separately if for no other reason than to facilitate verification that the common data products of LSST can actually be displayed in useful ways.

\paragraph{Image Display Tools}\hfill  % Force subsequent text onto new line

\subparagraph{Multi-Image Scaling and Aligning}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0073}
\textbf{ID:} DMS-PRTL-REQ-0073

\textbf{Specification:}
The Portal aspect shall have the capability to display multiple images on a common astrophysical coordinate scale and aligned on the screen in a common astrophysical orientation.

\textbf{Discussion:}
The point behind this requirement is to enable viewing the same part of the sky in different filters aligned to same orientation and scaled to the same screen resolution for both single-frame and coadded images.

\subparagraph{Provide Coordinate Display Tools for Images}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0070}
\textbf{ID:} DMS-PRTL-REQ-0070

\textbf{Specification:}
The Portal shall provide all the capabilities in the Coordinate Display Tools section herein for image displays.  Specific capabilities will depend on the availability of WCS information for an image.

\subparagraph{Image Appearance Manipulation}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0074}
\textbf{ID:} DMS-PRTL-REQ-0074

\textbf{Specification:}
The Portal aspect shall enable the user to change the view of a displayed image including, but not necessarily limited to, the color table, the stretch function, and the displayed data range.

\subparagraph{Image Spatial Manipulation}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0072}
\textbf{ID:} DMS-PRTL-REQ-0072

\textbf{Specification:}
The Portal aspect shall have the capability to resize, rescale, re-project, zoom, and crop the image display and save or download the current view.

\subparagraph{Image Pixel Content Display}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0071}
\textbf{ID:} DMS-PRTL-REQ-0071

\textbf{Specification:}
The Portal aspect shall have the capability to inspect the pixel content of an image at the position of the mouse cursor.  This capability shall be integrated with the Point Coordinate Display capability for the image.

\paragraph{Image Overlays}\hfill  % Force subsequent text onto new line

These capabilities concern the overlay of additional information on an image by matching to one of its coordinate systems.

\subparagraph{Image Plot Overlays}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0076}
\textbf{ID:} DMS-PRTL-REQ-0076

\textbf{Specification:}
The Portal aspect shall enable the overlaying of tabular data on an image, either based on pixel coordinates or astrophysical coordinates, as supported by the availability of coordinate system information.

\textbf{Discussion:}
More generally, this should work for any two-dimensional plot data that shares a coordinate system with an image.  The catalog data need not be semantically linked with the image by anything other than the coordinate system used.

\subparagraph{Image Overlays: Adjustment of Colors and Positions}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0077}
\textbf{ID:} DMS-PRTL-REQ-0077

\textbf{Specification:}
The Portal aspect shall have the capability for a user to configure the annotations, colors, transparency, and positions (where applicable) of any image overlays, including those resulting from the use of the Coordinate Tools.

\textbf{Discussion:}
Often the default color and position of the overlay needs to be changed for clarification.

\subparagraph{Image Mask and Variance Overlays}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0075}
\textbf{ID:} DMS-PRTL-REQ-0075

\textbf{Specification:}
The Portal aspect shall enable the overlaying of additional pixel-oriented data on an image, including image masks (bit planes) and variance data.

\textbf{Discussion:}
This also enables, but does not require, the overplotting of two-dimensional density plots such as depth maps.

\paragraph{Image Property Sheet}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0069}
\textbf{ID:} DMS-PRTL-REQ-0069

\textbf{Specification:}
The Portal shall have the ability to display a property sheet for an image data product or user-provided image, displaying image format and other header data.

\textbf{Discussion:}
This is information on the image artifact itself, e.g., on the contents of FITS headers.  It should not be confused with the property sheet associated with an image metadata table entry, though there may be a strong overlap in content, and for UX purposes they may be displayed in combined screens.

\paragraph{Display Single Visit Image Cut-Out}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0064}
\textbf{ID:} DMS-PRTL-REQ-0064

\textbf{Specification:}
The Portal aspect shall have the capability to display a cutout from a single visit image.

\textbf{Discussion:}
Corresponds to the ability to request the generation of cutouts and cross-CCD mosaics.

\paragraph{Display Calibration Image Data Products}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0067}
\textbf{ID:} DMS-PRTL-REQ-0067

\textbf{Specification:}
The Portal aspect shall have the capability to display the calibration image data products such as synthetic flats, bias frames, and the like.

\textbf{Discussion:}
Note that these images may not have WCS information.

\paragraph{Display Native Single-Visit Image Data Products}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0062}
\textbf{ID:} DMS-PRTL-REQ-0062

\textbf{Specification:}
The Portal aspect shall have the ability to display the native single-visit image data products, including raw images, Processed Visit Images (PVIs), and difference images, as well as the standard single-exposure calibration images used as inputs for flats, bias frames, etc.

\textbf{Discussion:}
The native raw data will contain amplifier-level data with full pre-scan, serial overscan, and parallel overscan.
The other native single-visit data products will be at CCD level.

\paragraph{Display Native Coadded Image Data Products}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0065}
\textbf{ID:} DMS-PRTL-REQ-0065

\textbf{Specification:}
The Portal aspect shall have the capability to display the native coadded image data products, i.e., the patch-level images.

\paragraph{Display User-provided Images}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0068}
\textbf{ID:} DMS-PRTL-REQ-0068

\textbf{Specification:}
The Portal aspect shall have the capability to display user-provided images in widely-used astronomical community formats, including FITS, and shall properly interpret a variety of commonly-used WCS specifications in the image headers.

\textbf{Discussion:}
This would be used, for instance, to allow a user to view LSST catalog data superposed on a user-provided image.  FITS is the only currently supported image file format; others will be considered as community usage develops or as part of supporting all-sky visualization.

\paragraph{Display Coadded Image Cutouts / Mosaics}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0066}
\textbf{ID:} DMS-PRTL-REQ-0066

\textbf{Specification:}
The Portal aspect shall have the capability to display cutouts and mosaics from coadded image data products, as delivered from the API aspect.

\textbf{Discussion:}
Corresponds to the ability to request the generation of cutouts and mosaics.  These may cover areas both smaller than and larger than the native "patch" scale.

\paragraph{Display Raft- and Focal-Plane-Level Single-Visit  Image Data}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0063}
\textbf{ID:} DMS-PRTL-REQ-0063

\textbf{Specification:}
The Portal aspect shall have the capability to generate a synthetic display of image data at raft level and at full focal plane (FPA) level.

\textbf{Discussion:}
No such data products will exist \textit{per se}; the requirement is for the Portal to be able to show, e.g., the coverage of raft-level or FPA-level visit imaging on the sky.

\subsubsection{All-Sky Visualization}

\paragraph{Zoom In and Out on a HEALPix Image}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0079}
\textbf{ID:} DMS-PRTL-REQ-0079

\textbf{Specification:}
The Portal aspect shall enable a user to zoom in and out on a HEALPix all-sky image.

\textbf{Discussion:}
The zooming in and out will enable a user to change effective spatial resolution of the image on the screen, tranferring across levels of the image hierarchy.

\paragraph{HEALPix Pixel Selection}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0081}
\textbf{ID:} DMS-PRTL-REQ-0081

\textbf{Specification:}
The Portal aspect shall enable a user to select individual HEALPix pixels or groups of pixels and obtain references to them which can be used in other LSP aspects.

\textbf{Discussion:}
UI selection of pixels, at selectable scales, can be done in the Portal, with the selections then used in other aspects.

\paragraph{Retrieve HEALPix-Associated Data}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0082}
\textbf{ID:} DMS-PRTL-REQ-0082

\textbf{Specification:}
The Portal aspect shall enable a user to retrieve metadata and data associated with selected HEALPixels and display that information as tabular or image data as appropriate.

\textbf{Discussion:}
The HEALPix pixels will be associated with metadata (e.g., which objects are associated with that position on the sky) or data (e.g., what is the FWHM of all of the sources within that pixel on the sky).  That metadata/data will be retrievable via a selection of the HEALPix pixels.

\paragraph{Pan Around on a HEALPix Image}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0080}
\textbf{ID:} DMS-PRTL-REQ-0080

\textbf{Specification:}
The Portal aspect shall enable a user to move around within a HEALPix all-sky image when the full image is not displayed on the screen.

\textbf{Discussion:}
The panning is intended to enable a user to move around on the sky with a fixed zoom level.  Panning does not apply if the full all-sky image is visible on the screen.

\paragraph{Display All-Sky HEALPix Image}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0078}
\textbf{ID:} DMS-PRTL-REQ-0078

\textbf{Specification:}
The Portal aspect shall be able to display an all-sky image in the HEALPix format.

\textbf{Discussion:}
In addition to flux images such as all-sky coadds, the LSST pipelines and/or quality assessment processes may generate a variety of all-sky metrics, diagnostics, and other artifacts in this format.

\subsubsection{Coordinate Display Tools}

These tools are intended to be useful in any two-dimensional display of data in a well-defined spatial coordinate system: images as well as x-y plots where the axes are spatial.

\paragraph{Astrophysical Compass Overlay}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0087}
\textbf{ID:} DMS-PRTL-REQ-0087

\textbf{Specification:}
The Portal aspect shall have the capability to display a North-East Compass on an image or two-dimensional plot with a known astrophysical coordinate system.

\textbf{Discussion:}
So the user knows that the (particularly for the generally randomly rotated single-epoch data) which directions are North and East.

\paragraph{Coordinate Grid Overlays}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0086}
\textbf{ID:} DMS-PRTL-REQ-0086

\textbf{Specification:}
The Portal aspect shall have the capability to display one or more coordinate grids on top of images or two-dimensional plots with a known astrophysical coordinate system.

\textbf{Discussion:}
The point behind this requirement is to enable viewing of equatorial, galactic, and ecliptic coordinates overlays at the same time.

\paragraph{Geometric Figure Overlays}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0088}
\textbf{ID:} DMS-PRTL-REQ-0088

\textbf{Specification:}
The Portal aspect shall enable the drawing, display, and selection of a closed 2-dimensional polygon on any two-dimensional image.

\textbf{Discussion:}
This is a general requirement that enables the overlay of a polygon on an image or a plot.  A polygon could be a circle, an ellipse, or an N-vertices polygon.  The purpose of this is enable area selection on the images or plots.

\paragraph{Point Coordinate Display}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0084}
\textbf{ID:} DMS-PRTL-REQ-0084

\textbf{Specification:}
The Portal aspect shall have the capability to inspect the coordinates in a two-dimensional display that correspond to the position of the mouse cursor.  When coordinate system conversion information is available, display of all available coordinates shall be supported.  In particular, when available (e.g., for data associated with single-epoch and calibration images) the coordinate display shall include focal plane array electronic as well as  spatial coordinates.  When available (i.e., for an image, when a WCS is present) the coordinate display shall include astrophysical coordinates.

\textbf{Discussion:}
When applied to images and at high zoom levels, the UI shall make clear whether pixel center coordinates or continuous cursor-location coordinates are being displayed.

\paragraph{Coordinate Display Applicability}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0083}
\textbf{ID:} DMS-PRTL-REQ-0083

\textbf{Specification:}
The Portal aspect shall have the capability to provide the set of coordinate system display and measurement tools in this section for any two-dimensional data display where both coordinates have a spatial interpretation, except as further specified below.

\textbf{Discussion:}
The knowledge that coordinates in an x-y plot are spatial will in general depend on the availability of suitable metadata to define the coordinates.

\paragraph{Distance Measurement Tool}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0085}
\textbf{ID:} DMS-PRTL-REQ-0085

\textbf{Specification:}
The Portal aspect shall have the capability to determine the distance between two positions within an image or 2-dimensional plot in both image/plot coordinates (electronic or spatial X and Y) and in astrophysical coordinates (if applicable).  Calculations shall be performed in spherical geometry where appropriate.

\textbf{Discussion:}
The point behind this requirement is to enable distance determinations of equatorial, galactic, and ecliptic coordinates and make sure spherical geometry is used.
When applied to general two-dimensional plots, distance measurement should only be supported when a metric and a geometry, or at least the relative scale between the two displayed coordinates, is known.
This means that this capability is particularly dependent on metadata support.

\subsubsection{Visualization of Ancillary Information}

\label{DMS-PRTL-REQ-0043}
\textbf{ID:} DMS-PRTL-REQ-0043

\textbf{Specification:}
The Portal aspect shall include the ability to visualize selected ancillary information produced by the LSST pipeline including, but not limited to, image regions, image bit-planes, survey footprints, focal-plane footprints and PSF representations.

\textbf{Discussion:}
The intent here is to call attention to the fact there is more than just the survey images and coadds that are have a “2-dimension” form that need to be visualized and presented to the user in the interface.
The specific ancillary data products to visualize will be determined during construction, based in part on feedback received during PDAC operation and the use of the Portal tools by developers.
It is desirable that custom visualizations be available for important and frequently used ones such as Footprints (which can readily be displayed as pixel overlays).  Where dedicated Portal visualizations are not available, however, users should be able to use either LSST-provided or community libraries in the Notebook aspect to create custom visualizations.

\subsubsection{Visualization of Uploaded Tabular and Image Data}

\label{DMS-PRTL-REQ-0045}
\textbf{ID:} DMS-PRTL-REQ-0045

\textbf{Specification:}
The Portal aspect shall support a convenient workflow for the visualization of uploaded tabular and image data products.

\textbf{Discussion:}
The idea is to provide something close to a one-button "show me this" workflow.

\subsubsection{Visualization of Tabular and Image Data}

\label{DMS-PRTL-REQ-0042}
\textbf{ID:} DMS-PRTL-REQ-0042

\textbf{Specification:}
The Portal aspect shall provide the capability to visualize all tabular and image data products in the DPDD, as well as user data products.

\textbf{Discussion:}
The products in the DPDD are the primary data products for use by the LSST users.  The "tabular and image" qualification indicates that the Portal is not required to provide a dedicated visualization for all data products that do not naturally fall into one of those categories.
For user data products, the amount of detail and labeling, and the amount of UI support, will be less if they lack the full level of metadata that comes with the Project's own data products.

\subsubsection{Visualization of Workspace Data}

\label{DMS-PRTL-REQ-0046}
\textbf{ID:} DMS-PRTL-REQ-0046

\textbf{Specification:}
The Portal aspect shall support a convenient workflow for the visualization of data selected in a workspace browser.

\textbf{Discussion:}
This should appear as a standard "select and open" workflow, with the Portal determining a reasonable action to take based on its determination of the type of Workspace data selected.

\subsubsection{Linking Visualization of Image Data to Tabular Data}

\label{DMS-PRTL-REQ-0044}
\textbf{ID:} DMS-PRTL-REQ-0044

\textbf{Specification:}
The Portal aspect shall provide the capability for the user to navigate between visualized tabular data and visualized image data.

\textbf{Discussion:}
For instance, there should be very simple UI support to display an image based on a row in an image metadata table, or to navigate from a selected source overplotted on an image to further information about that source.

\subsection{Exploration and Analysis}

Requirements in this section are unique to the Portal aspect.  The equivalent functionality in the Notebook aspect simply arises from its nature as an open programming environment.

\subsubsection{Table Manipulation}

\paragraph{Saving Displayed Tabular Data}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0095}
\textbf{ID:} DMS-PRTL-REQ-0095

\textbf{Specification:}
The Portal aspect shall provide the capability to save and or download tabular data as it is displayed in the interface maintaining the content, filtering, and sorting.

\textbf{Discussion:}
This intent of this requirement is enable the user to manipulate the table (e.g., sorting, filtering, calculated quantities and save that table to either workspace or in an offline download).

\paragraph{Calculated Filtering of Tabular Data}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0091}
\textbf{ID:} DMS-PRTL-REQ-0091

\textbf{Specification:}
The Portal aspect shall provide the capability to filter a table by single column where the filter has simple arithmetic calculations applied to the column values, including but not limited to sqrt, log, log10, exponentials and trigonometric functions.

\textbf{Discussion:}
The intent of this requirement is enable simple arithmetic functions on the values in the columns prior and then do the filtering on that value (e.g., X*0.33 < 10).

\paragraph{Sorting of Tabular Data by Column}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0089}
\textbf{ID:} DMS-PRTL-REQ-0089

\textbf{Specification:}
The Portal aspect shall provide the capability to sort tabular data by a single column within the table and redisplay the sorted table.

\textbf{Discussion:}
This is the traditional sorting by one column.

\paragraph{Simple Filtering of Tabular Data}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0090}
\textbf{ID:} DMS-PRTL-REQ-0090

\textbf{Specification:}
The Portal aspect shall provide the capability to filter tabular data by a single column, including but not limited to less than (<), less than or equal (<=), greater than (>), greater than or equal (=>), equal (=), not equal (!=) and not null (!=null).

\textbf{Discussion:}
The intent of this requirement is enable simple one-dimensional filtering on a single column or a series of columns and-ed together.

\paragraph{Calculated Quantities on Tabular Data}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0093}
\textbf{ID:} DMS-PRTL-REQ-0093

\textbf{Specification:}
The Portal aspect shall provide the capability to add an additional column to the displayed table based upon an arithmetic operations on columns within the displayed table and display the new column.

\textbf{Discussion:}
This intent of this requirement is enable the user to combine columns in the table to form a new column that can be included in the table and used in the same manner as the intrinsic columns.

\paragraph{Filtering of Tabular Data by Multiple Columns}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0092}
\textbf{ID:} DMS-PRTL-REQ-0092

\textbf{Specification:}
The Portal aspect shall provide the capability to filter tabular data by multiple columns within the table and redisplay the filtered table.

\textbf{Discussion:}
Apply filters from various columns.

\paragraph{Statistical Measurements on Tabular Data}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0094}
\textbf{ID:} DMS-PRTL-REQ-0094

\textbf{Specification:}
The Portal aspect shall enable the capability to perform a set of statistical measurements (e.g., mean, median, RMS, skew, kurtosis) on tabular data selected by the user.

\subsubsection{Image Manipulation}

\paragraph{Statistical Measurements on Image Data}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0097}
\textbf{ID:} DMS-PRTL-REQ-0097

\textbf{Specification:}
The Portal aspect shall enable the capability to perform a set of statistical measurements (e.g., mean, median, RMS, skew, kurtosis) on user-selected regions in images.

\paragraph{False-color Images Creation and Display}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0096}
\textbf{ID:} DMS-PRTL-REQ-0096

\textbf{Specification:}
The Portal aspect shall have the capability to create and display false-color images composed from any user-selectable set of filters from multiple filter views of the same region.

\subsubsection{Special Workflows}

The following requirements describe specific workflows or screens that combine various Portal capabilities to deliver scientifically useful functions.

\paragraph{Display of Camera Artifacts as Overlays}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0102}
\textbf{ID:} DMS-PRTL-REQ-0102

\textbf{Specification:}
The Portal aspect shall have the capability to display a camera artifacts including but not limited to image crosstalk matrices, ghost image identifications, saturation, and column bleeding.

\textbf{Discussion:}
The intent of this requirement is to enable the users to be able to see where artifacts may be affecting the data. These artifacts may not be stored in image format and may need to be reconstructed algorithmically.

\paragraph{Overlay LSST-Derived Tracks and Tracklets}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0099}
\textbf{ID:} DMS-PRTL-REQ-0099

\textbf{Specification:}
The Portal aspect shall have the capability to overlay tracks and tracklets from the LSST catalog on to images.

\textbf{Discussion:}
The point of this requirement is enable the user to overlay mutiple tracks on an image.

\paragraph{Overlay User-provided Region Files on Images}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0101}
\textbf{ID:} DMS-PRTL-REQ-0101

\textbf{Specification:}
The Portal aspect shall be able to overlay user-provided region files (e.g., DS9 region files, focal plane outlines) on images.

\paragraph{Data Selection from a Plot or Image}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0107}
\textbf{ID:} DMS-PRTL-REQ-0107

\textbf{Specification:}
The Portal aspect shall enable the selection of data contained inside or outside a closed 2-dimensional polygon on an xy-plot, 2-dimension data structure (e.g., density plot), and a 2-dimenstional image.

\textbf{Discussion:}
This is a general requirement that enables the selection of data from inside or outside a polygon.

\paragraph{Overlay Catalog of Sources and Objects on Images}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0098}
\textbf{ID:} DMS-PRTL-REQ-0098

\textbf{Specification:}
The Portal aspect shall be able to overlay the positions of catalog sources and objects on a displayed image based upon astrophysically-based or observatory-based coordinates.

\paragraph{Linked Tables, Plots, and Images}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0106}
\textbf{ID:} DMS-PRTL-REQ-0106

\textbf{Specification:}
The Portal aspect shall have the capability to have tabular data, plots, and images with overlays connected via brushing and linking.

\textbf{Discussion:}
Updates to the data in any one visualization tool (e.g., plot, image, table) creates an update in other visualization tools.  For example, selection of a set of photometry points in a color-color plot causes the corresponding rows in an Object table and symbols on an image to be highlighted; or, application of a selection predicate to a table causes the corresponding points in a plot to be highlighted.

\paragraph{Single-Object Time-Domain Image View}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0103}
\textbf{ID:} DMS-PRTL-REQ-0103

\textbf{Specification:}
The Portal aspect shall have the capability to view an image time series that maintains the same physical scale, photometric scale, and image size display of a cutout area centered on an LSST object

\textbf{Discussion:}
If the object moves, then the images stay centered on the object.

\paragraph{Position-based Time-Domain Image View}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0104}
\textbf{ID:} DMS-PRTL-REQ-0104

\textbf{Specification:}
The Portal aspect shall have the capability to view an image time series that maintains the same physical scale, photometric scale, and image size display of a specified position on the sky.

\textbf{Discussion:}
If the object moves, then the images stay centered on the sky and the object appears to move.

\paragraph{Overlay User-provided Catalogs on Images}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0100}
\textbf{ID:} DMS-PRTL-REQ-0100

\textbf{Specification:}
The Portal aspect shall be able to overlay user-provided source lists or catalogs on images.

\paragraph{Saving Data Selection from a Plot or Image}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0108}
\textbf{ID:} DMS-PRTL-REQ-0108

\textbf{Specification:}
The Portal aspect shall enable the saving of data selected via a polygon selection across the linked images, tables, and plots.

\textbf{Discussion:}
An example here is to have an image up; draw a polygon on the image to select the area on the sky.  All the tabular data associated with sources and objects in that part of the sky would be selected and saved.

\paragraph{Brightness Light Curves}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0105}
\textbf{ID:} DMS-PRTL-REQ-0105

\textbf{Specification:}
The Portal aspect shall have the capability to display graphically the brightness/magnitude of an LSST Object or Source or Forced Source as a function of time.

\textbf{Discussion:}
This is a specific implementation of the xy-plot capabilities

\subsection{User Storage}

\subsubsection{Access to User Databases (Level 3 Data Products)}

\label{DMS-PRTL-REQ-0109}
\textbf{ID:} DMS-PRTL-REQ-0109

\textbf{Specification:}
The Portal aspect shall provide read/write access to user databases (Level 3 tabular data products) and shall implement any access restrictions placed on such data.

\subsection{Transfer Data}

\subsubsection{Image Data Download}

\label{DMS-PRTL-REQ-0111}
\textbf{ID:} DMS-PRTL-REQ-0111

\textbf{Specification:}
The Portal aspect shall include mechanisms for a user to download image data to a remote site or to the Workspace, from both screens displaying images and screens displaying lists of image metadata.

\textbf{Discussion:}
Again, this should be implemented as a pass-through to the API aspect.

\subsubsection{Selected Image Download}

\label{DMS-PRTL-REQ-0112}
\textbf{ID:} DMS-PRTL-REQ-0112

\textbf{Specification:}
The Portal aspect shall support user selection for download of a subset of the images in an image metadata table or image cutout table.

\subsubsection{Tabular Data Download}

\label{DMS-PRTL-REQ-0110}
\textbf{ID:} DMS-PRTL-REQ-0110

\textbf{Specification:}
The Portal aspect shall include a mechanism for a user to download to a remote site, Workspace, or to an existing or new user database the tabular results from a database query, including for catalog or image metadata.

\textbf{Discussion:}
This may be implemented as a pass-through to the API aspect when applied to the results of a query against an LSST database.

\subsubsection{Download Volume Estimation}

\label{DMS-PRTL-REQ-0113}
\textbf{ID:} DMS-PRTL-REQ-0113

\textbf{Specification:}
The Portal aspect shall provide an estimate of the data download volume prior to a user confirming the download option.

\textbf{Discussion:}
The intent of this requirement is to enable the users to understand how large a query result or data set may be prior to the full retrieval and downloading of that data to either the workspace environment or their own local environment.

\subsubsection{Long Download Completion Notification}

\label{DMS-PRTL-REQ-0114}
\textbf{ID:} DMS-PRTL-REQ-0114

\textbf{Specification:}
The Portal aspect shall notify the user with an estimate of how long a download is expected to take. The user can continue to monitor the download; an option shall be provided to notify the user when the download has completed.

\textbf{Discussion:}
DAX requirement for async

\subsection{Control and Management}

\subsubsection{Alert Subscription}

\paragraph{User-defined Alert Filters}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0121}
\textbf{ID:} DMS-PRTL-REQ-0121

\textbf{Specification:}
The Portal aspect shall provide an interface to permit alert subscriptions to be configured with user-defined alert filters.

\paragraph{Pre-defined Alert Filters}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0120}
\textbf{ID:} DMS-PRTL-REQ-0120

\textbf{Specification:}
The Portal aspect shall provide an interface to permit alert subscriptions to be configured with Project-provided alert filters.

\paragraph{Alert Subscription Service}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0119}
\textbf{ID:} DMS-PRTL-REQ-0119

\textbf{Specification:}
The Portal aspect shall provide an interface to the alert subscription service that allows authenticated users with LSST data rights to subscribe to a stream of alert events.

\textbf{Discussion:}
This is just a UI for the underlying capability developed under 02C.03.03.
Note that users without data rights will have to subscribe to alerts through brokers external to the LSST project.

\subsubsection{Computational Quotas User Interface}

\label{DMS-PRTL-REQ-0117}
\textbf{ID:} DMS-PRTL-REQ-0117

\textbf{Specification:}
The Portal aspect shall provide the user with an understanding of the current status of their allocations.

\textbf{Discussion:}
This requirement is about the SUIT implementing the quotas defined by the DM system.  Those requirements need to defined and work through by the Project and the DM.

\subsubsection{APIs for Visualization Components}

\label{DMS-PRTL-REQ-0115}
\textbf{ID:} DMS-PRTL-REQ-0115

\textbf{Specification:}
The Portal aspect shall provide a documented application program interface that allows users and services at any location to access and manipulate the Portal's visualization services

\textbf{Discussion:}
This is intended to be enable API control of the visualization components and tool-level visualization services to be called and controlled through an API.
There will be a Web API as well as a Python wrapper for it.

\subsubsection{Portal Display Preferences}

\label{DMS-PRTL-REQ-0118}
\textbf{ID:} DMS-PRTL-REQ-0118

\textbf{Specification:}
The Portal aspect shall enable a user to establish and save viewing preferences, including, but not limited to, which tabular data columns to view, how tables should be sorted by default, which calculated quantities appear within a table, what image stretch and color tables, what types of plots are generated, how data are overlaid on images.

\textbf{Discussion:}
The intent behind this requirement is to enable user to set up a working environment within the default portal or the workspace environment and be able to save the state of the workflow.

\subsubsection{Storage Quotas User Interface}

\label{DMS-PRTL-REQ-0116}
\textbf{ID:} DMS-PRTL-REQ-0116

\textbf{Specification:}
The Portal aspect shall provide the user with an understanding of the current status of their storage allocations

\textbf{Discussion:}
This requirement is about the SUIT implementing the quotas defined by the DM system.  Those requirements need to defined and work through by the Project and the DM.

\subsection{Documentation}

"Documentation" refers, essentially, to curated human-written information that is largely static.  E.g., a description of the survey strategy is documentation; a Web page displaying the current progress of the survey is not.

\subsubsection{Portal API Documentation}

\label{DMS-PRTL-REQ-0124}
\textbf{ID:} DMS-PRTL-REQ-0124

\textbf{Specification:}
The Portal aspect shall provide reference-manual-style documentation on its public network and programmatic APIs.

\textbf{Discussion:}
This may include network APIs that allow interaction with a Portal session's state, Python APIs including wrappers for the network APIs, and JavaScript APIs for the components of the Portal application.
This requirement is somewhat redundant with the general DM requirement that all code be supplied with reference documentation, but emphasizes a coherent presentation of the APIs relevant to the Portal.

\subsubsection{Access to Observatory Documentation}

\label{DMS-PRTL-REQ-0122}
\textbf{ID:} DMS-PRTL-REQ-0122

\textbf{Specification:}
The Portal aspect shall provide access to Project-provided documentation on the design, construction, and operation of the LSST.

\textbf{Discussion:}
Much of this will be just a link or links to documentation whose creation is out of the scope of DM.  The DM documentation will include documentation on the code, on the pipeline processing, and on the delivered data quality.  Note that documentation on the Science Platform itself will also be included.

\subsubsection{Portal User Documentation}

\label{DMS-PRTL-REQ-0123}
\textbf{ID:} DMS-PRTL-REQ-0123

\textbf{Specification:}
The Portal aspect shall provide user-guide-style documentation on the use of the Portal.

\subsection{Overview}

\subsubsection{Portal is a Web Application}

\label{DMS-PRTL-REQ-0001}
\textbf{ID:} DMS-PRTL-REQ-0001

\textbf{Specification:}
The Portal aspect shall be accessible through commonly used desktop web browsers without requiring users to download and install local software packages.

\textbf{Discussion:}
The supported browsers will be documented by the Project.

\subsection{General}

\subsubsection{Performance Requirements}

Substantially more work needs to be done on codifying performance requirement for the components of the LSP.

\subsubsection{Implementation}

\paragraph{System-Busy Indication}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0126}
\textbf{ID:} DMS-PRTL-REQ-0126

\textbf{Specification:}
The Portal aspect shall provide a means to inform users when elements of the system are unavailable.

\textbf{Discussion:}
This might be due to maintenance or to excessive load.

\paragraph{Tolerance of Production Database Changes}\hfill  % Force subsequent text onto new line

\label{DMS-PRTL-REQ-0125}
\textbf{ID:} DMS-PRTL-REQ-0125

\textbf{Specification:}
The Portal aspect shall be designed to facilitate accommodation of database expansion and changes and metadata extension and changes associated with the evolution of the Level 1 data, Level 2 data releases, and other planned data sources.

\textbf{Discussion:}
The LSP needs to accommodate the database changes associated with Level 1 and Level 2 updates; this also has implications for DAX - see the "Discovery and Reflection APIs" requirement - and for the availability of the data as they are released with the processing (nightly and annually).  This requires stability for the APIs (web and client), and usability of the Portal across releases (and for multiple releases).

\subsubsection{Identity and Security}

\section{Notebooks}

\subsection{Discover Data}

\subsection{Query Data}

\subsubsection{General Tabular Queries}

\paragraph{Specific Query Types}\hfill  % Force subsequent text onto new line

\subparagraph{Temporal Queries}\hfill  % Force subsequent text onto new line

\subparagraph{Spatial Queries}\hfill  % Force subsequent text onto new line

\textsc{Spatial Query Parameters}

\textsc{Spatial Query Types}

\subparagraph{Identifier Queries}\hfill  % Force subsequent text onto new line

\subsubsection{Catalog Queries}

\subsubsection{Image Metadata Queries}

\subsubsection{Image Cutout Queries}

\subsection{Display Data}

\subsubsection{Display Tabular Data}

\paragraph{Property Sheets}\hfill  % Force subsequent text onto new line

\paragraph{Table Viewers}\hfill  % Force subsequent text onto new line

\paragraph{Tabular Data Graphing}\hfill  % Force subsequent text onto new line

\subsubsection{Display Image Data}

\paragraph{Image Display Tools}\hfill  % Force subsequent text onto new line

\paragraph{Image Overlays}\hfill  % Force subsequent text onto new line

\subsubsection{All-Sky Visualization}

\subsubsection{Coordinate Display Tools}

\subsection{Exploration and Analysis}

\subsubsection{Table Manipulation}

\subsubsection{Image Manipulation}

\subsubsection{Special Workflows}

\subsection{User Storage}

\subsection{Transfer Data}

\subsection{Control and Management}

\subsubsection{Alert Subscription}

\subsection{Documentation}

\subsection{Overview}

\subsection{General}

\subsubsection{Performance Requirements}

\subsubsection{Implementation}

\subsubsection{Identity and Security}

\section{Data Access Interface}

\subsection{Discover Data}

\subsection{Query Data}

\subsubsection{General Tabular Queries}

\paragraph{Specific Query Types}\hfill  % Force subsequent text onto new line

\subparagraph{Temporal Queries}\hfill  % Force subsequent text onto new line

\subparagraph{Spatial Queries}\hfill  % Force subsequent text onto new line

\textsc{Spatial Query Parameters}

\textsc{Spatial Query Types}

\subparagraph{Identifier Queries}\hfill  % Force subsequent text onto new line

\subsubsection{Catalog Queries}

\subsubsection{Image Metadata Queries}

\subsubsection{Image Cutout Queries}

\subsection{Display Data}

\subsubsection{Display Tabular Data}

\paragraph{Property Sheets}\hfill  % Force subsequent text onto new line

\paragraph{Table Viewers}\hfill  % Force subsequent text onto new line

\paragraph{Tabular Data Graphing}\hfill  % Force subsequent text onto new line

\subsubsection{Display Image Data}

\paragraph{Image Display Tools}\hfill  % Force subsequent text onto new line

\paragraph{Image Overlays}\hfill  % Force subsequent text onto new line

\subsubsection{All-Sky Visualization}

\subsubsection{Coordinate Display Tools}

\subsection{Exploration and Analysis}

\subsubsection{Table Manipulation}

\subsubsection{Image Manipulation}

\subsubsection{Special Workflows}

\subsection{User Storage}

\subsection{Transfer Data}

\subsection{Control and Management}

\subsubsection{Alert Subscription}

\subsection{Documentation}

\subsection{Overview}

\subsection{General}

\subsubsection{Performance Requirements}

\subsubsection{Implementation}

\subsubsection{Identity and Security}

\bibliography{lsst}

\end{document}
